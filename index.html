<html>
<title>gym_session</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<input id="randb" type="button" value="Random program">
<div id="functionality"></div>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="gym_moves.json"></script>

<script>
   // wait document to load up before doing anything, can use also $(function(){
   $(document).ready(function() {
   
      var maxmoves = 10
   
      // clickfunction for randomizer button
      $('#randb').click(function validateForm() {
         // make a temporary copy of all moves that we will cut down
         var available_moves = gym_moves.slice()
         
         // random how many moves to do today
         var howmany = Math.floor((Math.random() * maxmoves) + 1)
         var session_moves = []
         for (i = 0; i < howmany; i++) {
            var selected_move = Math.floor(Math.random() * available_moves.length)
            session_moves.push(available_moves[selected_move])
            available_moves.splice(selected_move, 1)
         }
         console.log(available_moves)
      
         var all_muscles = calc_unique_muscles(gym_moves)
         var muscles_in_session = calc_unique_muscles(session_moves)
         var coverage = muscles_in_session.length/all_muscles.length
      
         // print page
         document.getElementById("functionality").innerHTML = ""
         for (i = 0; i < session_moves.length; i++) {
            document.getElementById("functionality").innerHTML += session_moves[i][0]
            document.getElementById("functionality").innerHTML += "<br>"
         }
         document.getElementById("functionality").innerHTML += "<br><br>"
         document.getElementById("functionality").innerHTML += "Muscles in this session:<br>"
         document.getElementById("functionality").innerHTML += muscles_in_session
         document.getElementById("functionality").innerHTML += "<br><br>"
         document.getElementById("functionality").innerHTML += "All muscles in database:<br>"
         document.getElementById("functionality").innerHTML += all_muscles
         document.getElementById("functionality").innerHTML += "<br><br>"
         document.getElementById("functionality").innerHTML += "Muscle coverage: " + Math.floor(coverage*100).toString() + "%"
      });
      
      function calc_unique_muscles(movelist) {
         var all_muscles = []
         for (i = 0; i < movelist.length; i++) {
            all_muscles = all_muscles.concat(movelist[i][1])
         }
      
         // calculate all unique muscles
         return(Array.from(new Set(all_muscles)))
      }

   });
</script>
</html>